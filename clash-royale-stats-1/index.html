<!DOCTYPE html>
<html lang="no">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Clash Royale stats</title>
	<link rel="stylesheet" href="styles.css">
</head>
<body onload="testingAPI()">
	<header class="page-top">
		<h1>Clash Royale stats</h1>

		<nav class="main-nav">
			<ul>
				<li><a class="active" href="index.html">Mitt lag</a></li>
				<li><a href="cards.html">Tilgjengelige kort</a></li>
			</ul>
		</nav>
	</header>

	<main class="content">
		<div id="clashDataContainer"></div>
	</main>

	<footer class="page-footer">

	</footer>

<script>
	function testingAPI(){
	    var key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTc4NywiaWRlbiI6IjQwMjc1Nzc0Mjc0NzQ1MT\
M5MiIsIm1kIjp7fSwidHMiOjE1Mzg2NjQ3OTQ2Mjd9.0JLa2j04z96C3iwkDcPVO_PP6G3jnyFJ_RQ7OVzQmow";
	    var url = "https://api.royaleapi.com/player/JYG8VPL";

	    var clashDataContainer = document.getElementById("clashDataContainer");
	    var clashData = JSON.parse(httpGet(url, key));

	    var clashMyName = "<dt>Navn:</dt> <dd>" + clashData.name + "</dd>";
	    var clashMyTrophies = "<dt>Trofeer:</dt> <dd>" + clashData.trophies + "</dd>";
	    var clashMyClan = "<dt>Klan:</dt> <dd>" + clashData.clan.name + "</dd>";

	    var currentDeckCount = clashData.currentDeck.length;
	    var currentDeckString = "<table class='clash-table'><thead>" +
	    	"<tr>" +
		    	"<td>&nbsp;</td>" +
		    	"<th>Navn</th>" +
		    	"<th class='level'>Level</th>" +
		    	"<th class='level'>Maks level</th>" +
		    	"<th>NÃ¸kkel</th>" +
		    	"<th>Beskrivelse</th>" +
	    	"</tr></thead><tbody>";
	    for (i = 0; i < currentDeckCount; i++) {
    		currentDeckString +=
    			"<tr>" +
    				"<td class='clash-icon-cell'>" +
    					"<img class='clash-icon' src='" + clashData.currentDeck[i].icon + "' />" +
    				"</td>" +
	    			"<td>" +
	    				clashData.currentDeck[i].name +
					"</td><td class='clash-level'>" +
						clashData.currentDeck[i].level +
					"</td><td class='clash-level'>" +
						clashData.currentDeck[i].maxLevel +
					"</td><td class='clash-level'>" +
						clashData.currentDeck[i].elixir +
					"</td><td>" +
						clashData.currentDeck[i].description +
					"</td>" +
				"</tr>";
    	}
    	currentDeckString += "</tbody>";

	    clashDataContainer.innerHTML =
	    	"<dl class='my-clash'>" +
		    	clashMyName +
		    	clashMyTrophies +
		    	clashMyClan +
	    	"</dl>" +
	    	currentDeckString;
	}

	function httpGet(url,key){
	    var xmlHttp = new XMLHttpRequest();
	    xmlHttp.open( "GET", url, false );
	    xmlHttp.setRequestHeader("auth",key);
	    xmlHttp.send(null);
	    return xmlHttp.responseText;
	}
</script>
</body>
</html>
